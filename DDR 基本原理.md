## 常见的存储器
存储器，主要用来存储程序和各种数据，并能在计算机运行过程中高速、自动完成程序或数据的存取。
### ROM(Read Only Memory) 只读存储器
+ 作用
装入整机前事先写好的，整机工作过程中只能读出。
+ 特点
ROM 所存数据稳定，断电后数据也不会改变
+ 发展
SDRAM、DRAM、DDR

### RAM(Random Access Memory)随机访问存储器
+ 作用
与CPU直接交换数据的内部存储器，也叫主存（内存）。它可以随时读写而且速度很快，通常作为操作系统或其他正在运行钟河的程序的临时数据存储媒介。
+ 特点
电源关闭时RAM不能保留数据
+ 发展
SDRAM、DRAM、DDR
#### RAM 分类
+ SRAM
静止存取功能的内存，不需要刷新电路即能保存它内部存储的数据，前提是加电的条件下。
+ DRAM
数据保存很短的时间，使用电容存储。必须隔一段时间刷新一次。
## DDR
全称，DDR(Double Data Rate) SDRAM(Synchronous Dynamic Random Access memory)。Double Data Rate：与传统的单数据速率相比，DDR技术实现了一个时钟周期内进行两次读/写操作，即在时钟的上升沿和下降沿分别执行一次读/写操作。

## 内存原理
从内存控制器到内存颗粒的逻辑，从大到小：
channel -> DIMM -> Rank -> chip -> bank -> row -> colunm
以I7 CPU为例：


![c37db387a9b3ffd3f7872e8645dabf04.png](:/52eecc49b6f84cddb4ffc557d3ad7a31)

支持两个Channel(双通道)，每个Channel 上可以插两个DIMM，每个DIMM由两个 rank 构成，8个chip组成一个rank。
+ Channel
一个主板上可能有多个插槽，用来插多根内存。这些槽位分成两组或多组，组内共享物理信号线。这样的一组信号线、对应几个槽位（内存条）称为一个channel.
+ DIMM(dual inline memory module)
主板上的一个内存槽。一个channel 可以包含多个DIMM。
+ RANK

### chip 和 bank


![63699de42b8e08594ddb2263e7350b93.png](:/f75e13190fa0456ba2856f813c3bde79)


以DDR3未例，左边是1个 rank，由8个128M chip组成，而1个chip又由8个Bank 组成，每个 Bank 核心是一个存储矩阵。这个矩阵由很多列（Column）和 很多行（Row）。

+ 位宽
每个格子的存储宽度是内存颗粒(chip)的宽度。以2GB DDR3位例：


![20200801144032895.png](:/0ebb925ea2f74c3cbd849d51975cb72c)

#### 引脚功能
一个格子包含的引脚：
+ 电源
+ 地
+ 配置
+ 控制信号
+ 时钟信号                                                                   
+ 地址信号
    + BG0: Bank Group 地址选择
    + BA[0:1] Bank地址选择
    + A[0:16] 地址选择信号，其中A16 还有RAS_N功能
+ 数据信号

#### BankGroup
DDR4 有20根地址线（17根Address，2根BA，1根BG),16根数据线。为什么这个分配呢？我们首先如果全部将20根地址用来寻址，则寻址最大容量：
(2^20) * 16 = 2MB
但是 DDR 最大容量可以做到1GB，实现的技术既分时复用，做法：
（1）首先将存储空间分成两大块，分别为Bank Group0 和 Bank Group1，再用一根地址线（还剩19根），命名为BG，进行编码。
（2） 再将一个Bank Group区域划分成4个Bank小区域，分贝命名为 BANK0、BANK1、BANK2、BANK3。使用2根地址线（剩余17根）命名为BA0 和 BA1。
这样我们就把DDR 内存颗粒划分成了2个BANK GROUP ，每个BANK GROUP 又分成了4个BANK。共8个BANK区域。

#### BANK 设计
剩下的17根地址线，第一次用来表示行地址，第二次用来表示列地址。现在修改为传输2次地址，再传输2次数据，寻址范围最多被扩展为2GB。
优点：传输速度降低了一半，但是存储空间被扩展了很多倍。
剩下的17根地址，留一根用来表示传输地址是否为行地址。
+ 第一次传输时，行地址选择使能，剩下16根地址线，可以表示行地址范围。
+ 第二次传输时，行地址选择禁用，剩下16根地址线，其中0根列地址线表示列地址范围，剩下6根用来表示读写状态/刷新状态/行使能、等等复用功能。

所以 1个Bank 可以分成65536 行，每行 1024列，每个存储单元16bit。
+ 每行可以存储1024 * 16BIT = 2KB，每行的存储的容量，称为Page Size。
+ 单个Bank 共2^16行，所以每个Bank存储容量为2^10 * 2KB = 128M. 

